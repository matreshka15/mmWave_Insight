# 多普勒效应

!!! abstract "本章学习路线"
    📚 **我们将学习**：

    1. 🎶 从声波入手，理解多普勒效应的本质
    2. 📡 推导雷达中的多普勒频移公式
    3. 📊 学会计算目标速度
    4. 🛡️ 了解盲速和解模糊问题

    ⏱️ **预计时间**：25-35 分钟

## 🎶 从生活开始：你听过多普勒效应

!!! example "🚑 经典场景：救护车的警笛声"
    想象你站在路边，一辆救护车快速驶来…

    ```mermaid
    graph LR
        A[👤 你] -->|1. 车驶近| B[🚑 呀——]
        A -->|2. 车经过| C[🚑 哦——]
        A -->|3. 车远离| D[🚑 呵——]

        style B fill:#ff6b6b
        style C fill:#ffd93d
        style D fill:#4dabf7
    ```

    - **驶近** → 声音变尖锐（高音调） 🔺
    - **经过** → 正常音调
    - **远离** → 声音变低沉（低音调） 🔻

    这就是 **多普勒效应**！

??? tip "更多生活例子 🌟"
    - 🚄 **火车鸣笛**：经过月台时音调变化
    - 🏎️ **F1 赛车**：引擎声的音调变化
    - 🚁 **飞机起降**：引擎噪音的频率变化
    - ⛷️ **球速雷达**：棒球比赛中测量球速

## 📘 物理原理

### 什么是多普勒效应？

!!! info "科学定义"
    **多普勒效应**（Doppler Effect）：当波源与观察者之间存在相对运动时，观察者接收到的波频率会发生变化。

    **简单记忆**：

    - 🚀 **相对靠近** → 频率↑ 升高
    - 🚀 **相对远离** → 频率↓ 降低
    - ⏸️ **没有相对运动** → 频率不变

### 🎵 声波中的多普勒公式

声波中的频率变化公式：

$$
\boxed{f' = f \frac{v \pm v_o}{v \mp v_s}}
$$

??? info "参数详解 📖"
    | 符号 | 名称 | 说明 |
    |------|------|------|
    | $f$ | 源频率 | 声源本身的频率 |
    | $f'$ | 观察频率 | 你听到的频率 |
    | $v$ | 波速 | 声速 (340 m/s) |
    | $v_o$ | 观察者速度 | 你的运动速度 |
    | $v_s$ | 声源速度 | 救护车的速度 |

??? example "🧮 实际计算例子"
    **场景**：救护车以 30 m/s (108 km/h) 驶来，警笛频率 1000 Hz。

    **驶近时**：
    $$
    f' = 1000 \times \frac{340}{340-30} = 1000 \times \frac{340}{310} \approx 1097 \text{ Hz}
    $$

    **远离时**：
    $$
    f' = 1000 \times \frac{340}{340+30} = 1000 \times \frac{340}{370} \approx 919 \text{ Hz}
    $$

    **频率变化**：1097 - 919 = **178 Hz**，你能明显听出差别！

## 雷达中的多普勒效应

### 推导

对于雷达系统，电磁波以光速 $c$ 传播，目标以速度 $v$ 相对雷达运动。

#### 单程多普勒频移

目标接收到的频率：

$$
f_1 = f_0 \left(1 + \frac{v_r}{c}\right)
$$

#### 双程多普勒频移

目标反射后，雷达接收到的频率：

$$
f_r = f_1 \left(1 + \frac{v_r}{c}\right) = f_0 \left(1 + \frac{v_r}{c}\right)^2
$$

由于 $v_r \ll c$，可以近似为：

$$
f_r \approx f_0 \left(1 + \frac{2v_r}{c}\right)
$$

### 多普勒频移

定义多普勒频移 $f_d$：

$$
\boxed{f_d = f_r - f_0 = \frac{2v_r f_0}{c} = \frac{2v_r}{\lambda}}
$$

其中：

- $v_r$ 是径向速度（正值表示靠近，负值表示远离）
- $\lambda$ 是雷达工作波长
- $c$ 是光速

### 符号约定

通常约定：

- 目标靠近雷达：$v_r > 0$，$f_d > 0$（正多普勒）
- 目标远离雷达：$v_r < 0$，$f_d < 0$（负多普勒）
- 目标横向运动：$v_r = 0$，$f_d = 0$（零多普勒）

## 📐 径向速度与实际速度

### 基本关系

目标的实际速度 $v$ 与径向速度 $v_r$ 的关系：

$$
v_r = v \cos\theta
$$

其中 $\theta$ 是速度方向与雷达视线的夹角。

```mermaid
graph LR
    A[雷达] -->|视线方向| B[目标]
    B -->|速度v| C[ ]

    style A fill:#e1f5ff
    style B fill:#ffe1e1
```

### 特殊情况汇总

| 场景 | 角度 $\theta$ | 径向速度 $v_r$ | 多普勒频移 $f_d$ | 特点 |
|------|-------------|--------------|----------------|------|
| **正面靠近/远离** | 0° / 180° | $\pm v$ | 最大 | 全速分量 |
| **横向运动** | 90° | 0 | 0（盲速） | 无径向分量 |
| **斜向运动** | 0° < θ < 90° | $0 < v_r < v$ | 部分 | 速度分解 |

## 🧮 多普勒频移计算

### 不同频段的多普勒频移对比

对于速度 $v = 100$ km/h = 27.78 m/s：

| 频段 | 频率 | 波长 | $f_d$ (Hz) | 应用场景 |
|-----|------|------|-----------|----------|
| S | 3 GHz | 10 cm | 556 | 远程监视雷达 |
| X | 10 GHz | 3 cm | 1852 | 气象雷达 |
| Ku | 15 GHz | 2 cm | 2778 | 卫星通信 |
| Ka | 35 GHz | 8.6 mm | 6481 | 交通雷达 |
| **77 GHz** | **77 GHz** | **3.9 mm** | **14256** | **汽车雷达** |
| W | 94 GHz | 3.2 mm | 17361 | 短程探测 |

!!! note "关键观察"
    - ✅ 频率越高，多普勒频移越大
    - ✅ 毫米波雷达的多普勒频移显著（>10 kHz）
    - ✅ 更容易进行精确速度测量

### 速度测量分辨率

由观测时间 $T$ 决定：

$$
\Delta f_d = \frac{1}{T}
$$

对应的速度分辨率：

$$
\Delta v = \frac{\lambda}{2T}
$$

!!! example "示例"
    对于 77 GHz 雷达，$\lambda = 3.9$ mm，观测时间 $T = 50$ ms：

    $$
    \Delta v = \frac{0.0039}{2 \times 0.05} = 0.039 \text{ m/s} = 0.14 \text{ km/h}
    $$

## 📊 多普勒频谱

### 不同目标类型的频谱特征

| 目标类型 | 频谱形式 | 数学表达式 | 特点 |
|---------|---------|-----------|------|
| **点目标** | 单一频率峰 | $S(f) = \delta(f - f_d)$ | 理想情况 |
| **多目标** | 多个频率峰 | $S(f) = \sum_{i=1}^{N} A_i \delta(f - f_{d,i})$ | 多个离散峰 |
| **扩展目标** | 频谱展宽 | $S(f) = \frac{1}{\sqrt{2\pi\sigma_d^2}} \exp\left(-\frac{(f-f_d)^2}{2\sigma_d^2}\right)$ | 高斯分布 |

### 扩展目标展宽原因

| 序号 | 原因 | 说明 | 典型场景 |
|------|------|------|----------|
| 1 | **速度差异** | 目标不同部位速度不同 | 车辆前后部 |
| 2 | **旋转振动** | 目标自身旋转或振动 | 引擎振动 |
| 3 | **相对加速** | 雷达与目标相对加速度 | 加减速过程 |

## 多普勒处理

### 脉冲多普勒雷达

#### 慢时间采样

对于脉冲雷达，相邻脉冲的回波构成慢时间序列：

$$
s(m) = A e^{j2\pi f_d m T_r}, \quad m = 0, 1, \ldots, M-1
$$

其中 $T_r$ 是脉冲重复周期。

#### FFT 处理

对慢时间序列进行 FFT 得到多普勒谱：

$$
S(k) = \sum_{m=0}^{M-1} s(m) e^{-j2\pi km/M}
$$

频率分辨率：

$$
\Delta f_d = \frac{1}{M T_r} = \frac{f_r}{M}
$$

### FMCW 雷达

#### 2D-FFT 处理

FMCW 雷达通过 2D-FFT 同时获得距离和速度信息：

1. **第一次 FFT**（快时间）：距离信息
2. **第二次 FFT**（慢时间）：速度信息

结果是距离-多普勒图（Range-Doppler Map）。

```text
距离 FFT → [距离 bin]
    ↓
多普勒 FFT
    ↓
[距离-多普勒图]
```

## 多普勒模糊

### 盲速问题

当多普勒频移为 PRF 的整数倍时，会出现盲速：

$$
v_{blind} = n \frac{\lambda f_r}{2} = n \frac{\lambda}{2T_r}
$$

其中 $n = 1, 2, 3, \ldots$

### 最大不模糊速度

由奈奎斯特采样定理，最大不模糊速度：

$$
v_{max} = \frac{\lambda f_r}{4}
$$

!!! warning "权衡"
    - 高 PRF：大的不模糊速度，但距离模糊
    - 低 PRF：大的不模糊距离，但速度模糊

### 解决方法

1. **多 PRF 技术**
   - 使用多个 PRF 交替发射
   - 通过中国剩余定理解模糊

2. **相位编码**
   - 对发射信号进行相位调制
   - 增加速度测量范围

3. **FMCW 雷达**
   - 不受 PRF 限制
   - 速度范围主要由帧时间决定

## 运动补偿

### 平台运动影响

对于机载或车载雷达，平台自身的运动会引入额外的多普勒频移：

$$
f_d^{total} = f_d^{target} + f_d^{platform}
$$

### 运动补偿方法

1. **IMU/GPS 辅助**
   - 使用惯导或 GPS 测量平台速度
   - 从多普勒测量中减去平台分量

2. **参考目标**
   - 使用静止参考目标（如地面）
   - 校准平台运动

3. **DPCA（Displaced Phase Center Antenna）**
   - 多通道相位中心偏置天线
   - 抑制静止杂波

## 🎯 多普勒雷达的应用

### 应用领域汇总表

| 序号 | 应用类别 | 技术/系统 | 具体应用 | 典型频率 |
|------|---------|----------|----------|----------|
| **1** | **速度测量** | 交通测速雷达 | 车辆测速、超速检测 | 24/35 GHz |
| | | 运动检测 | 球速测量、工业监测 | 10/24 GHz |
| **2** | **目标检测** | MTI | 运动目标指示、杂波抑制 | X/S 波段 |
| | | STAP | 时空自适应、弱小目标检测 | X 波段 |
| **3** | **微多普勒** | 步态识别 | 人体四肢摆动特征 | 77/94 GHz |
| | | 无人机检测 | 旋翼调制信号 | 77 GHz |
| | | 生命体征 | 呼吸、心跳监测 | 24/60 GHz |
| | | 手势识别 | 手部动作识别 | 60 GHz |
| **4** | **SAR 成像** | 多普勒波束锐化 | 合成孔径雷达、高分辨成像 | X/C 波段 |

## 实际应用示例

### 示例 1：汽车雷达测速

**系统参数**：

- 频率：$f_0 = 77$ GHz
- 波长：$\lambda = 3.9$ mm
- 目标速度：$v = 120$ km/h = 33.33 m/s
- 入射角：$\theta = 0°$（正面）

**计算**：

径向速度：
$$v_r = v \cos(0°) = 33.33 \text{ m/s}$$

多普勒频移：
$$f_d = \frac{2v_r}{\lambda} = \frac{2 \times 33.33}{0.0039} = 17094 \text{ Hz} \approx 17.1 \text{ kHz}$$

### 示例 2：侧向检测

**系统参数**：

- 频率：$f_0 = 77$ GHz
- 波长：$\lambda = 3.9$ mm
- 目标速度：$v = 60$ km/h = 16.67 m/s
- 入射角：$\theta = 45°$

**计算**：

径向速度：
$$v_r = v \cos(45°) = 16.67 \times 0.707 = 11.79 \text{ m/s}$$

多普勒频移：
$$f_d = \frac{2 \times 11.79}{0.0039} = 6046 \text{ Hz} \approx 6.0 \text{ kHz}$$

!!! note "观察"
    侧向检测的多普勒频移约为正面检测的 $\cos(45°) \approx 0.707$ 倍

### 示例 3：速度分辨率

**系统参数**：

- 波长：$\lambda = 3.9$ mm
- 相参积累时间：$T = 100$ ms

**速度分辨率**：

$$
\Delta v = \frac{\lambda}{2T} = \frac{0.0039}{2 \times 0.1} = 0.0195 \text{ m/s} \approx 0.07 \text{ km/h}
$$

这个分辨率足以区分相近速度的车辆。

## 多普勒与 FMCW 雷达

在 FMCW 雷达中，多普勒效应会影响频率测量：

### 上扫频

$$
f_{beat,up} = f_R + f_d
$$

### 下扫频

$$
f_{beat,down} = f_R - f_d
$$

### 距离和速度解耦

$$
f_R = \frac{f_{beat,up} + f_{beat,down}}{2}
$$

$$
f_d = \frac{f_{beat,up} - f_{beat,down}}{2}
$$

从而得到：

$$
R = \frac{c f_R T_c}{2B}
$$

$$
v = \frac{\lambda f_d}{2}
$$

---

## 下一步

- [FMCW 调制](../mmwave/fmcw.md) - 学习 FMCW 雷达的工作原理
- [信号处理](../mmwave/signal-processing.md) - 深入多普勒信号处理
- [目标检测](../mmwave/target-detection.md) - 了解基于多普勒的目标检测

## 参考资料

1. Richards, M. A. (2014). *Fundamentals of Radar Signal Processing*. McGraw-Hill.
2. Chen, V. C. (2019). *The Micro-Doppler Effect in Radar*. Artech House.
3. Skolnik, M. I. (2008). *Radar Handbook*. McGraw-Hill.
